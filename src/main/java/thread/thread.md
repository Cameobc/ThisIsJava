#멀티 스레드(Multi Thread)

------------
1. 프로세스와 스레드
   - 프로세스 : 운영체제에서 실행 중인 하나의 애플리케이션
   - 멀티태스킹 : 두 가지 이상의 작업을 동시에 처리하는 것을 의미하며, 운영체제가 병렬로 실행시킨다.
   - 하나의 프로세스가 두 가지 이상의 작업을 처리할 수 있는 것은 멀티 스레드 덕분이다.
   - 멀티 프로세스가 애플리케이션 단위의 멀티 태스킹이라면 멀티 스레드는 애플리케이션 내부에서의 멀티 태스킹이라고 볼 수 있다.
   - 멀티 프로세스들은 운영체제에서 할당받은 자신의 메모리를 가지고 실행하기 때문에 서로 독립적이다.
   - 즉, 하나의 프로세스에서 오류가 발생해도 다른 프로세스에 영향을 미치지 않는다.
   - 하지만 멀티 스레드는 하나의 프로세스 내부에 생성되기 때문에 하나의 스레드가 예외를 발생시킬 경우, 프로세스 자체가 종료될 수 있어 다른 스레드들에 영향을 미치게 된다.
   - 그렇기 때문에 멀티 스레드에서는 예외 처리가 중요하다.
   
---
2. 메인 스레드
   - 모든 자바 애플리케이션은 메인 스레드가 main() 메소드를 실행하면서 시작된다
   - 메인 스레드는 필요에 따라 작업 스레드들을 만들어서 병렬로 코드를 실행할 수 있다.
   
---
3. 작업 스레드 생성과 실행
   - 자바에서는 작업 스레드도 객체로 생성되기 때문에 클래스가 필요하다.
   - 스레드 객체를 직접 생성하려면 Runnable 을 매개값으로 갖는 생성자를 호출해야 함.
     ```java
      Runnable task = new Task();
      Thread thread = new Thread(task);
      ```
   - 코드를 좀 더 절약하기 위해 익명 객체를 매개값으로 사용할 수 있음
     ```java
      Thread thread = new Thread(new Runnable(){
        public void run(){
            //스레드가 실행할 코드;
        }  
     });
      ```
   - Runnable 인터페이스는 run() 메소드 하나만 정의되어 있는 함수적 인터페이스 이기 때문에 람다식을 매개값으로 사용할 수도 있다.
     ```java
      Thread thread = new Thread(()->{
         //스레드가 실행할 코드;
        
     });
      ```
------------
4. 스레드 우선순위
   - 멀티 스레드는 동시성 또는 병렬성으로 실행된다.
      > - 동시성(Concurrency)
          : 멀티 작업을 위해 하나의 코어에서 멀티 스레드가 번갈아가며 실행하는 성질
      > - 병렬성(Parallelism) : 멀티 작업을 위해 멀티 코어에서 개별 스레드를 동시에 실행하는 성질
   - 싱글 코어 CPU 를 이용한 멀티 스레드 작업은 병렬적으로 실행되는 것처럼 보이지만 사실은 번갈아가며 실행하는 동시성 작업임
   - 스레드의 개수가 코어의 수보다 많을 경우, 스레드를 어떤 순서에 의해 동시성으로 실행할 것인가를 결정해야 하는데 이를 스레드 스케쥴링이라 한다.
   - 자바의 스레드 스케쥴링은 우선순위(Priority) 방식과 순환 할당(Round-Robin) 방식을 사용한다.
      > - 순환 할당 방식 : 시간 할당량을 정해서 하나의 스레드를 정해진 시간만큼 실행하고 다른 스레드를 실행. JVM이 제어
      > - 우선 순위 방식 : 우선순위가 높은 스레드가 실행 상태를 더 많이 가져가도록 스케쥴링. 개발자가 코드로 제어 가능. 1이 가장 우선순위가 낮고, 10이 가장 높으며 우선순위를 부여하지 않으면 모든 스레드들이 기본적으로 5의 우선순위를 가진다. setPriority() 메소드를 이용하여 우선순위를 지정가능하고, 코드의 가독성을 위해 직접 숫자를 입력하는 대신 Thread 클래스의 상수를 사용할 수도 있다.
------------
5. 동기화 메소드와 동기화 블록
   - 공유 객체를 사용할 때, 멀티 스레드 프로그램에서는 스레드들이 객체를 공유해서 작업해야 하는 경우가 있으며, 이때 한 스레드가 사용 중인 객체를 다른 스레드가 변경할 수 있따.
   - 이를 막기 위해 스레드 작업이 끝날 때까지 객체에 잠금을 걸어 다른 스레드가 사용할 수 없도록 해야 한다.
   - 멀티 스레드 프로그램에서 단 하나의 스레드만 실행할 수 있는 코드 영역을 임계 영역(critical section) 이라 부르며, 자바는 이를 지정하기 위해 동기화(synchronized) 메소드와 동기화 블록을 제공한다.
   - 스레드가 객체 내부의 동기화 메소드 또는 블록에 들어가면 즉시 객체에 잠금을 걸어 다른 스레드가 임계 영역 코드를 실행하지 못하도록 한다.
   - 동기화 메소드를 만들기 위해서는 메소드 선언에 synchronized 키워드를 붙이면 되며, 이는 인스턴스와 정적 메소드 어디에든 붙일 수 있다.
   - 동기화 블록 내부에서 하나가 실행 중일 때, 다른 스레드와 동기화 메소드 및 블록은 실행할 수 없지만 일반 메소드는 실행 가능하다.